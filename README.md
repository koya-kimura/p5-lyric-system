# Lyrics System

このリポジトリは、ライブ演出のために歌詞表示を制御する p5.js + TypeScript プロジェクトです。コントロール画面とパフォーム画面の 2 役割を持ち、ブラウザだけで歌詞キューイング、手動入力、演出モーションを扱えます。

## 機能概要
- コントロール / パフォームの 2 ロールを URL パラメータで切り替え。
- JSON マニフェストと CSV から歌詞を読み込み、曲・行ごとに選択可能。
- 手動入力テキストの即時反映、タイポ修正が容易な UI。
- 複数の歌詞モーション（フェード、スライドなど）を選択して演出を切替え。
- モーション用のテンポ（BPM）をリアルタイムに更新し、タイミングを制御。
- フォントレジストリから選択したフォントをプレビューし、次の歌詞更新で適用。
- フィードバックのための FPS テレメトリ共有。
- p5.js（WebGL）での描画とポストエフェクト用シェーダー適用。

## セットアップ
```bash
npm install
npm run dev
```
ブラウザで `http://localhost:5173` を開きます。パフォーム画面を開くには `?role=perform` を付けます。例: `http://localhost:5173/?role=perform`

## プロジェクト構成
```
public/
  data/             歌詞 CSV とマニフェスト
  shader/           ポストエフェクト用シェーダー
src/
  app/              クライアント起動と UI
  core/             パラメータ、描画、テレメトリ管理
  movements/        歌詞アニメーション実装
  scenes/           p5 シーン制御
  utils/            イージングなどの補助関数
```

## 主なフロー
1. `npm run dev` で開発サーバーを起動。
2. ブラウザでコントロール画面を開き、曲を選択。
3. 歌詞行をクリックまたは Enter でキューを進める。
4. 手動入力に切り替える場合はテキストエリアへ入力して「表示を更新」。
5. 必要に応じてモーションやテンポを変更し、演出を調整。

## ビルド
```bash
npm run build
npm run preview
```

## データ追加
1. `public/data/songs/` に新しい CSV を追加（1 列目を歌詞行として扱います）。
2. `public/data/manifest.json` に `title` と `file` パスを登録。
3. 開発サーバーを再読み込みすると歌詞が選択可能になります。

## ライセンス
MIT License